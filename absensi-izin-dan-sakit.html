<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <title>ABSENSI MAHASISWA & SISWA</title>
</head>

<body class="bg-gray-200 flex justify-center items-center h-screen">
    <!-- Container untuk iframe -->
    <div class="w-full max-w-full bg-white">
        <iframe id="gform" class="w-full" style="height: 100vh;" scrolling="no"></iframe>
    </div>

    <script>
        // Cek apakah locationVerified true
        if (sessionStorage.getItem("locationVerified") !== "true") {
            Swal.fire({
                icon: 'warning',
                title: 'Akses Ditolak',
                text: 'Anda harus berada dalam area yang ditentukan untuk mengakses halaman ini.',
                confirmButtonText: 'Kembali'
            }).then(() => {
                window.location.href = "home.html";
            });
        } else {
            // Mengatur src iframe setelah halaman dimuat
            var iframe = document.getElementById('gform');
            iframe.src = "https://script.google.com/macros/s/AKfycbxSPctyIeBud2Z5ACg-R60c3Vq49jkbmDtS6wB_QAt0NLpHuGqDgrkhoCAmF1bfwVPW-Q/exec";

            // Sesuaikan tinggi iframe secara otomatis
            iframe.onload = function () {
                iframe.style.height = iframe.contentWindow.document.body.scrollHeight + 'px';
            };

            // Tangani error jika iframe gagal dimuat
            iframe.onerror = function () {
                Swal.fire({
                    icon: 'error',
                    title: 'Not Found',
                    text: 'Halaman tidak dapat dimuat. Coba lagi nanti.',
                    confirmButtonText: 'Tutup'
                });
            };
        }
    </script>
</body>

</html>
