<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base target="_top" />
    <meta charset="UTF-8" />
    <script src="https://cdn.tailwindcss.com"></script>
<script>
    const centerLatitude = -5.10819;
    const centerLongitude = 119.43231;
    const radiusInMeters = 23.25;

    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371000;
        const φ1 = lat1 * Math.PI / 180;
        const φ2 = lat2 * Math.PI / 180;
        const Δφ = (lat2 - lat1) * Math.PI / 180;
        const Δλ = (lon2 - lon1) * Math.PI / 180;

        const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +
            Math.cos(φ1) * Math.cos(φ2) *
            Math.sin(Δλ / 2) * Math.sin(Δλ / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return R * c;
    }

    function checkLocationAndRedirect() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function (position) {
                    const userLatitude = position.coords.latitude;
                    const userLongitude = position.coords.longitude;

                    const distance = calculateDistance(userLatitude, userLongitude, centerLatitude, centerLongitude);

                    if (distance > radiusInMeters) {
                        Swal.fire({
                            icon: 'error',
                            title: 'Anda berada di luar radius!',
                            text: 'Silakan kembali ke lokasi yang benar untuk melakukan absensi.',
                        });
                    } else {
                        const absensiUrl = "4-biy.github.io/iframe/iframe.html";

                        // Deteksi apakah perangkat Android atau iOS
                        const isAndroid = /Android/i.test(navigator.userAgent);
                        const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

                        if (isAndroid) {
                            // Coba buka Chrome di Android menggunakan intent URL
                            window.location.href = `intent:${absensiUrl}#Intent;package=com.android.chrome;scheme=https://;end`;
                        } else if (isIOS) {
                            // Coba buka Chrome di iOS
                            setTimeout(() => {
                                window.location.href = `googlechrome://navigate?url=${absensiUrl}`;
                            }, 100); // Delay 100ms untuk memberikan waktu memeriksa Chrome
                        } else {
                            window.location.href = absensiUrl; // Buka di browser default jika bukan Android atau iOS
                        }
                    }
                },
                function (error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Gagal mengambil lokasi',
                        text: error.message,
                    });
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
            );
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Geolocation tidak didukung',
                text: 'Perangkat Anda tidak mendukung geolocation.',
            });
        }
    }
</script>

    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://kit.fontawesome.com/26d8d3b5e2.js" crossorigin="anonymous"></script>
</head>

<body>
    <div id="content">
        <div class="w-full scroll-smooth bg-slate-100">
            <div class="mx-auto min-h-screen overflow-hidden">
                <div class="w-full max-xl:px-8 bg-indigo-300">
                    <div class="max-w-screen-xl flex justify-center items-center gap-12 max-md:gap-6 mx-auto">

                        <img class="h-32 w-32 max-md:w-16 max-md:h-16 max-sm:my-8" src="Logoooo.png" alt="" />

                        <div class="text-center">
                            <small
                                class="xl:text-2xl md:text-base font-semibold inline-block pt-8 max-xl:pt-8 sm:block max-sm:hidden">PT
                                Industri Kapal Indonesia (Persero)</small>
                            <h1
                                class="xl:text-4xl md:text-lg w-fit text-balance xl:leading-1 0 pt-2 max-xl:pt-0 pb-8 font-bold sm:block max-sm:hidden">
                                Catatan Elektronik Mahasiswa Magang dan PKL Aktif dengan Keandalan Analisis
                            </h1>
                        </div>
                        <img class="h-32 w-32 max-md:w-16 max-md:h-16 max-sm:my-8"
                            src="https://upload.wikimedia.org/wikipedia/commons/6/67/Coat_of_arms_of_South_Sulawesi.svg"
                            alt="" />
                    </div>
                </div>
                <div
                    class="hidden max-sm:flex flex-col h-[55vh] px-8 max-sm:shadow-lg max-sm:shadow-indigo-950 box-border pt-8">
                    <small class="text-lg font-light mb-3">PT Industri Kapal Indonesia (Persero)</small>
                    <h1 class="text-4xl w-fit text-balance leading-[1.3em] font-medium">
                        Catatan Elektronik Mahasiswa Magang dan PKL Aktif dengan Keandalan Analisis
                    </h1>
                </div>
                <div class="max-sm:py-16 block mx-auto max-w-[1080px] px-8">
                    <h3 class="text-4xl mt-8 mb-12 font-bold text-center text-indigo-300 ">
                        Menu Aplikasi
                    </h3>
                    <ul class="flex flex-wrap justify-center items-center border-purple-400 gap-8">
                        <li>
                            <button onclick="checkLocationAndRedirect()"
                                class="flex flex-col duration-200 rounded-xl overflow-hidden justify-center items-center font-semibold gap-8 bg-indigo-300 hover:bg-indigo-200 hover:text-indigo-950 transition-all hover:scale-105 shadow-sm p-8 hover:border-2 hover:border-indigo-950"
                                type="button">
                                <p class="text-3xl text-center w-fit capitalize">Absensi</p>
                                <i class="fa-solid fa-user-check fa-9x"></i>
                            </button>
                        </li>
                        <li>
                            <button onclick="location.href='sertifikat.html'"
                                class="flex flex-col duration-200 rounded-xl overflow-hidden justify-center items-center font-semibold gap-8 bg-indigo-300 hover:bg-indigo-200 hover:text-indigo-950 transition-all hover:scale-105 shadow-sm p-8 hover:border-2 hover:border-indigo-950"
                                type="button">
                                <p class="text-3xl text-center w-fit capitalize">Sertifikat</p>
                                <i style="font-size: 150px;" class="fa-solid fa-file-circle-check fa-9x"></i>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
